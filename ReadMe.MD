Тестовое задание на позицию Data Engieneer.

Разработать решение в формате пайп-лайн по получению, нормализации и обработке данных из ТН ВЭД. 
Ссылка на справочник: https://www.nalog.gov.ru/rn77/program/5961290/  

По итогу должно быть разработано решение в формате реляционной базы данных учитывающая срок действия кодов, отношение родитель у кода и описание кодов.

Структура и количество таблиц, пакет использованных инструментов, модель хранения при реализации решения задачи на Ваш выбор. 


Решение:
Используемые инструменты:

1. Развернута локальная PostgreSQL  с помощью pgAdmin4 для возможности подключения к БД, создания таблиц и тестирования правильности их заполнения.
2. Для создания и наполнения БД был использован фреймворк для работы с реляционными базами данных SQLAclhemy.

Что получилось реализовать:
1. Реализовано полностью работоспособное решение по парсингу данных и загрузки их в соответствующие таблицы.
2. Файл source/models.py подключается к БД и создает 4 таблицы: ТНВЭД1, ТНВЭД2, ТНВЭД3, ТНВЭД4. Устанавливает значения столбцов и необходимые родительские связи, схема приложена.
3. Файл main.py собирает необходимые данные из справочников и заполняет таблицы.
4. Код протестирован и исполняется без ошибок.

Что не удалось реализовать из-за нехватки времени:
1. Не реализовано автоматическое скачивание и сохранение файлов с сайта налоговой. Необходимо вручную скать файлы и положить в папку Data.
2. Не реализована выгрузка исторических данных, поскольку это создает проблему неуникальности нужных кодов (Раздел и Группа). Выгружаются только данные об актуальных на сегодняшний день кодах. Если требуется выгрузка в т.ч. исторических данных, то требуется доп. время на поиск решения.
3. Не установлены родительские связи между таблицами ТНВЭД3 и ТНВЭД4 в силу неуникальности кода "товарная позиция". Требуется дополнительное время на поиск решения.
4. Не проведен рефакторинг части кода, связанного с наполнением таблиц. В коде прослеживается нарушение конвенции PEP8, самоповтор. Можно исправить, выделив нужные функции.